

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Deprecating an Old Config Variable &mdash; METplus 3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. GitHub Workflow" href="github_workflow.html" />
    <link rel="prev" title="4. Instructions for the Conda Environment" href="conda_env.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> METplus
          

          
            
            <img src="../_static/METplus_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">METplus Wrappers Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Users_Guide/index.html">User’s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributor’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coding_standards.html">1. Coding Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_components.html">2. Basic Components of METplus Python Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_wrapper.html">3. How to Create Your Own Wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="conda_env.html">4. Instructions for the Conda Environment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5. Deprecating an Old Config Variable</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">5.1. Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-for-deprecated-config">5.2. check_for_deprecated_config()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="github_workflow.html">6. GitHub Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">7. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="add_use_case.html">8. Adding Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html">9. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METplus</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Contributor’s Guide</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Deprecating an Old Config Variable</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Contributors_Guide/deprecation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deprecating-an-old-config-variable">
<h1><span class="section-number">5. </span>Deprecating an Old Config Variable<a class="headerlink" href="#deprecating-an-old-config-variable" title="Permalink to this headline">¶</a></h1>
<p>If a config variable changes names, we need to be able to alert the
user that they need to update the config files if they are using a
deprecated variable.</p>
<div class="section" id="example">
<h2><span class="section-number">5.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">exe</span><span class="p">]</span>
<span class="n">WGRIB2_EXE</span>
</pre></div>
</div>
<p>changed to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">exe</span><span class="p">]</span>
<span class="n">WGRIB2</span>
</pre></div>
</div>
<p>The new variable is set to wgrib2 in the default config file
(parm/metplus_config/metplus_system.conf). If the user is still using
WGRIB2_EXE to set to /usr/local/bin/wgrib2, this value will not be
read and the user will have no way to know that they are setting the
wrong variable and it is using WGRIB2 = wgrib2.</p>
</div>
<div class="section" id="check-for-deprecated-config">
<h2><span class="section-number">5.2. </span>check_for_deprecated_config()<a class="headerlink" href="#check-for-deprecated-config" title="Permalink to this headline">¶</a></h2>
<p>In met_util.py there is a function called
check_for_deprecated_config. It contains a dictionary of dictionaries
called deprecated_dict that specifies the old config name, the section
it was found in, and a suggested alternative (None if no alternative
exists).</p>
<p><strong>Example 1</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;WGRIB2_EXE&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sec&#39;</span> <span class="p">:</span> <span class="s1">&#39;exe&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span> <span class="p">:</span> <span class="s1">&#39;WGRIB2&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>this says that WGRIB2_EXE was found in the [exe] section and should
be replaced with WGRIB2.</p>
<p><strong>Example 2</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;PREPBUFR_DIR_REGEX&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sec&#39;</span> <span class="p">:</span> <span class="s1">&#39;regex_pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>
</div>
<p>this says that [regex_pattern] PREPBUFR_DIR_REGEX is no longer used
and there is no alternative (because the wrapper uses filename
templates instead of regex now).</p>
<p>If any of these old variables are found in any config file passed to
METplus by the user, an error report will be displayed with the old
variables and suggested new ones if applicable.</p>
<p>If we want to support an old config variable but warn the users that
they should still update because it will be phased out in the future,
you can add the ‘req’ item to the dictionary and set it to False. It
will warn the user but not stop execution. If this is done, you need
to be sure to modify the code to check for the new config and if it is
not set, check for the old config as well.</p>
<p><strong>Example</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;LOOP_METHOD&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sec&#39;</span> <span class="p">:</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span> <span class="p">:</span> <span class="s1">&#39;LOOP_ORDER&#39;</span><span class="p">,</span> <span class="s1">&#39;req&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>this says that [config] LOOP_METHOD is deprecated and you
should use LOOP_ORDER, but it is not required to change
immediately. If you do this, you should check for LOOP_ORDER and then
check for LOOP_METHOD if it is not set.</p>
<p>In master_metplus.py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loop_order</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getstr</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;LOOP_ORDER&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">loop_order</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">loop_order</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getstr</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;LOOP_METHOD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="github_workflow.html" class="btn btn-neutral float-right" title="6. GitHub Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="conda_env.html" class="btn btn-neutral float-left" title="4. Instructions for the Conda Environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, NCAR

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>